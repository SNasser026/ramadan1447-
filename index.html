<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø¬Ø¯ÙˆÙ„ Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø±Ù…Ø¶Ø§Ù† - Ø¬Ø§Ù…Ø¹ Ø§Ù„Ø¥Ù…Ø§Ù… Ø§Ù„Ø±Ø¨ÙŠØ¹ Ø¨Ù† Ø­Ø¨ÙŠØ¨</title>
<style>
/* Ø§Ø­ØªÙØ¸Øª Ø¨Ù†ÙØ³ CSS Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚ */
@import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap');
:root{
  --bg:#f0f4f2; --card:#ffffff; --accent:#1e8b63; --gold:#d4af37;
  --friday:#cfe3d6; --header-col:#49876d; --first-col:#49876d;
}
html, body{height:100%; margin:0; font-family:'Amiri', serif; background:var(--bg); color:#000; box-sizing:border-box;}
*, *::before, *::after { box-sizing: inherit; }
.container{ width:95%; max-width:1000px; margin:20px auto; padding:10px; }
.card{ background:var(--card); border-radius:14px; padding:1.5rem; border:4px solid var(--gold); box-shadow:0 8px 24px rgba(0,0,0,0.08); position:relative; }
.card-header { display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; }
#saveBtn, #printBtn { padding:0.5rem 1rem; border-radius:12px; cursor:pointer; font-weight:bold; color:#fff; font-size:1rem; border:none; margin:0.2rem; }
#saveBtn { background: var(--gold); } #saveBtn:hover { background: #c49b2c; }
#printBtn { background: var(--accent); } #printBtn:hover { background: #397155; }
#saveMessage { color: green; font-weight: bold; display: none; margin-left: 0.5rem; }
.table-wrapper{ overflow-x:auto; }
table{ width:100%; min-width:600px; border-collapse: collapse; font-size:1rem; background:#fff; border-radius:12px; border:1px solid var(--gold); }
thead th{ background:var(--header-col); color:#fff; text-align:center; padding:0.8rem; font-size:1rem; border:1px solid #a9a9a9; }
tbody td{ padding:0.6rem; text-align:center; border:1px solid #a9a9a9; }
tbody tr:nth-child(odd){ background: rgba(211,211,211,0.2); }
tbody tr:nth-child(even){ background: rgba(211,211,211,0.1); }
tbody tr.friday{ background-color:var(--friday) !important; }
tbody td:first-child{ background:var(--first-col); color:#fff; font-weight:700; }
table th:first-child, table td:first-child{ width:150px; }
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <div class="card-header">
      <div>
        <button id="saveBtn">ğŸ’¾ Ø­ÙØ¸</button>
        <span id="saveMessage">ØªÙ… Ø§Ù„Ø­ÙØ¸ Ø¨Ù†Ø¬Ø§Ø­ âœ…</span>
        <button id="printBtn">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
      </div>
    </div>
    <h1>Ø¬Ø¯ÙˆÙ„ Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ø±Ù…Ø¶Ø§Ù† 1447 Ù‡Ù€ - Ø¬Ø§Ù…Ø¹ Ø§Ù„Ø¥Ù…Ø§Ù… Ø§Ù„Ø±Ø¨ÙŠØ¹ Ø¨Ù† Ø­Ø¨ÙŠØ¨</h1>
    <div class="table-wrapper">
      <table id="mainTable">
        <thead>
          <tr>
            <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
            <th>Ø§Ù„ÙˆÙ‚Øª</th>
            <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø­Ø§Ø¶Ø±</th>
            <th>Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const tbody = document.querySelector("#mainTable tbody");
  const TOTAL_DAYS = 30;
  const START_DATE = new Date(2026, 1, 18);
  const weekdays = ["Ø§Ù„Ø£Ø­Ø¯","Ø§Ù„Ø§Ø«Ù†ÙŠÙ†","Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡","Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡","Ø§Ù„Ø®Ù…ÙŠØ³","Ø§Ù„Ø¬Ù…Ø¹Ø©","Ø§Ù„Ø³Ø¨Øª"];

  function createRows(data) {
    tbody.innerHTML = "";
    data.forEach(row => {
      const tr = document.createElement("tr");
      if (row.weekday === "Ø§Ù„Ø¬Ù…Ø¹Ø©") tr.classList.add("friday");

      const tdDate = document.createElement("td");
      tdDate.contentEditable = true;
      tdDate.textContent = row.date;
      tr.appendChild(tdDate);

      const tdTime = document.createElement("td");
      const selectTime = document.createElement("select");
      row.options.forEach(opt => {
        const option = document.createElement("option");
        option.value = opt;
        option.textContent = opt;
        if (opt === row.time) option.selected = true;
        selectTime.appendChild(option);
      });
      tdTime.appendChild(selectTime);
      tr.appendChild(tdTime);

      const tdName = document.createElement("td");
      tdName.contentEditable = true;
      tdName.textContent = row.name;
      tr.appendChild(tdName);

      const tdContact = document.createElement("td");
      tdContact.contentEditable = true;
      tdContact.textContent = row.phone;
      tr.appendChild(tdContact);

      tbody.appendChild(tr);
    });
  }

  async function fetchData() {
    const res = await fetch('/data');
    let data = await res.json();
    if (data.length === 0) {
      data = [];
      for (let i = 1; i <= TOTAL_DAYS; i++) {
        const currentDate = new Date(START_DATE);
        currentDate.setDate(START_DATE.getDate() + (i - 1));
        const weekdayName = weekdays[currentDate.getDay()];
        const options = (weekdayName === "Ø§Ù„Ø¬Ù…Ø¹Ø©")
          ? ["Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¬Ù…Ø¹Ø©", "Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹ØµØ±", "Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨", "Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡"]
          : ["Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹ØµØ±", "Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¸Ù‡Ø±", "Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨", "Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡"];
        data.push({
          date: `${currentDate.getDate()}/${currentDate.getMonth()+1}/${currentDate.getFullYear()} - ${weekdayName} - Ø±Ù…Ø¶Ø§Ù† ${i}`,
          weekday: weekdayName,
          time: options[0],
          options: options,
          name: "",
          phone: ""
        });
      }
      await fetch('/data', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify(data) });
    }
    createRows(data);
  }

  fetchData();

  document.getElementById("saveBtn").addEventListener("click", async () => {
    const trs = document.querySelectorAll("#mainTable tbody tr");
    const rows = [];
    trs.forEach(tr => {
      const tds = tr.querySelectorAll("td");
      const options = Array.from(tr.querySelector("select").options).map(o => o.value);
      rows.push({
        date: tds[0].textContent.trim(),
        weekday: tr.classList.contains("friday") ? "Ø§Ù„Ø¬Ù…Ø¹Ø©" : "",
        time: tds[1].querySelector("select").value,
        options: options,
        name: tds[2].textContent.trim(),
        phone: tds[3].textContent.trim()
      });
    });
    await fetch('/data', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify(rows) });
    const saveMessage = document.getElementById("saveMessage");
    saveMessage.style.display = "inline";
    setTimeout(() => { saveMessage.style.display = "none"; }, 2000);
  });

  document.getElementById("printBtn").addEventListener("click", () => window.print());
});
</script>
</body>
</html>
